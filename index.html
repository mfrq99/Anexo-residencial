<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anexo Residencial UC Christus</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBhN4t3uGfDwRZwN9r_k7egf5PjssfofJI",
  authDomain: "residencial-6b6b7.firebaseapp.com",
  databaseURL: "https://residencial-6b6b7-default-rtdb.firebaseio.com",
  projectId: "residencial-6b6b7",
  storageBucket: "residencial-6b6b7.firebasestorage.app",
  messagingSenderId: "171840259391",
  appId: "1:171840259391:web:c8d26aec2fc91f8058bf8a"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

/* CREDENCIALES */
const PACIENTE_RUT = "6921444-4";
const PACIENTE_FECHA = "1951-01-06";
const CLAVE_EQUIPO = "equipo123";
</script>

<style>
body{font-family:Segoe UI;background:#eef2f7;margin:0;padding:10px}
.container{max-width:500px;margin:auto;background:white;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,.1)}
.header{background:#007bff;color:white;padding:20px;text-align:center}
.nav{display:flex;background:#f8f9fa}
.nav div{flex:1;padding:10px;text-align:center;cursor:pointer;font-weight:bold;font-size:11px}
.nav div.active{background:white;color:#007bff;border-bottom:3px solid #007bff}
.section{display:none;padding:20px}
.section.active{display:block}
input,textarea,button{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc}
button{background:#28a745;color:white;font-weight:bold;border:none}
.info-box{background:#f1f8ff;padding:10px;border-radius:8px;margin-top:10px}
ul{padding-left:20px}
hr{border:none;border-top:1px solid #eee;margin:15px 0}
</style>
</head>

<body>
<div class="container">

<div class="header">
<h2>Anexo Residencial UC Christus</h2>
<small>Unidad de RecuperaciÃ³n y Regaloneo</small>
</div>

<div class="nav">
<div class="active" onclick="openTab('inicio',this)">RESIDENCIA</div>
<div onclick="openTab('paciente',this)">PACIENTE</div>
<div onclick="openTab('equipo',this)">EQUIPO</div>
</div>

<!-- INICIO -->
<div id="inicio" class="section active">
<div class="info-box">Seleccione una secciÃ³n</div>
</div>

<!-- PACIENTE -->
<div id="paciente" class="section">
<h3>Acceso Paciente</h3>

<input id="rutPaciente" placeholder="RUT">
<input type="date" id="fechaPaciente">
<button onclick="loginPaciente()">Ingresar</button>

<div id="ficha" style="display:none">

<hr>
<div class="info-box">
<b>Margarita Arriaza</b><br>
Nacimiento: 06-01-1951<br>
MÃ©dico tratante: Dr. Hazelnut Teo
</div>

<hr><h4>ğŸ’Š MedicaciÃ³n</h4>
<ul id="listaMedicacion"></ul>

<hr><h4>ğŸ©¸ PresiÃ³n Arterial</h4>
<ul id="listaPresion"></ul>

<hr><h4>ğŸ“‹ Controles</h4>
<ul id="listaControlesPaciente"></ul>

<hr><h4>ğŸ§ª ExÃ¡menes</h4>
<ul id="listaExamenesPaciente"></ul>

</div>
</div>

<!-- EQUIPO -->
<div id="equipo" class="section">
<h3>Acceso Equipo MÃ©dico</h3>

<input type="password" id="claveEquipo" placeholder="Clave equipo">
<button onclick="loginEquipo()">Ingresar</button>

<div id="panelEquipo" style="display:none">

<hr><h4>ğŸ’Š MedicaciÃ³n</h4>
<input id="medNombre" placeholder="Medicamento">
<input id="medHorarios" placeholder="Horarios ej 08:00,14:00">
<textarea id="medIndicacion" placeholder="Indicaciones"></textarea>
<button onclick="agregarMedicacion()">Agregar</button>
<ul id="listaMedicacionEquipo"></ul>

<hr><h4>ğŸ©¸ PresiÃ³n Arterial</h4>
<input type="date" id="presionFecha">
<input type="time" id="presionHora">
<input id="s1" placeholder="SistÃ³lica 1">
<input id="d1" placeholder="DiastÃ³lica 1">
<input id="s2" placeholder="SistÃ³lica 2">
<input id="d2" placeholder="DiastÃ³lica 2">
<input id="s3" placeholder="SistÃ³lica 3">
<input id="d3" placeholder="DiastÃ³lica 3">
<button onclick="agregarPresion()">Agregar</button>

<hr><h4>ğŸ“‹ Controles</h4>
<input id="controlDesc" placeholder="DescripciÃ³n">
<input type="date" id="controlFecha">
<input type="time" id="controlHora">
<button onclick="agregarControl()">Agregar</button>

<hr><h4>ğŸ§ª ExÃ¡menes</h4>
<input id="examenDesc" placeholder="DescripciÃ³n">
<input type="date" id="examenFecha">
<input type="time" id="examenHora">
<button onclick="agregarExamen()">Agregar</button>

</div>
</div>

<script>
function openTab(id,el){
 document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
 document.querySelectorAll('.nav div').forEach(n=>n.classList.remove('active'));
 document.getElementById(id).classList.add('active');
 el.classList.add('active');
}

/* LOGIN */
function loginPaciente(){
 if(rutPaciente.value===PACIENTE_RUT && fechaPaciente.value===PACIENTE_FECHA){
  document.getElementById("ficha").style.display="block";
 } else alert("Datos incorrectos");
}

function loginEquipo(){
 if(claveEquipo.value===CLAVE_EQUIPO){
  document.getElementById("panelEquipo").style.display="block";
 } else alert("Clave incorrecta");
}

/* FUNCIONES */
function agregarMedicacion(){
 database.ref("medicacion").push({
  nombre:medNombre.value,
  horarios:medHorarios.value.split(","),
  indicacion:medIndicacion.value
 });
 medNombre.value=medHorarios.value=medIndicacion.value="";
}

function agregarPresion(){
 database.ref("presion").push({
  fecha:presionFecha.value,
  hora:presionHora.value,
  mediciones:[
   {s:s1.value,d:d1.value},
   {s:s2.value,d:d2.value},
   {s:s3.value,d:d3.value}
  ]
 });
}

function agregarControl(){
 database.ref("controles").push({
  descripcion:controlDesc.value,
  fecha:controlFecha.value,
  hora:controlHora.value
 });
}

function agregarExamen(){
 database.ref("examenes").push({
  descripcion:examenDesc.value,
  fecha:examenFecha.value,
  hora:examenHora.value
 });
}

/* LISTENERS */
database.ref("medicacion").on("value",s=>{
 listaMedicacion.innerHTML="";
 listaMedicacionEquipo.innerHTML="";
 s.forEach(i=>{
  const d=i.val();
  listaMedicacion.innerHTML+=`<li>ğŸ’Š ${d.nombre}<br>â° ${d.horarios.join(" / ")}</li>`;
  listaMedicacionEquipo.innerHTML+=`<li>${d.nombre}</li>`;
 });
});

database.ref("presion").on("value",s=>{
 listaPresion.innerHTML="";
 s.forEach(i=>{
  const d=i.val();
  listaPresion.innerHTML+=`
  <li>${d.fecha} ${d.hora}<br>
  1ï¸âƒ£ ${d.mediciones[0].s}/${d.mediciones[0].d} |
  2ï¸âƒ£ ${d.mediciones[1].s}/${d.mediciones[1].d} |
  3ï¸âƒ£ ${d.mediciones[2].s}/${d.mediciones[2].d}</li>`;
 });
});

database.ref("controles").on("value",s=>{
 listaControlesPaciente.innerHTML="";
 s.forEach(i=>{
  const d=i.val();
  listaControlesPaciente.innerHTML+=`<li>ğŸ“‹ ${d.descripcion} ${d.fecha} ${d.hora}</li>`;
 });
});

database.ref("examenes").on("value",s=>{
 listaExamenesPaciente.innerHTML="";
 s.forEach(i=>{
  const d=i.val();
  listaExamenesPaciente.innerHTML+=`<li>ğŸ§ª ${d.descripcion} ${d.fecha} ${d.hora}</li>`;
 });
});
</script>

</body>
</html>
